<html><!-- #BeginTemplate "/Templates/ar_arulesxl.dwt" --><!-- DW6 -->
<!-- saved from url=about:internet -->
<head>
<link rel="stylesheet" type="text/css"
href="../../manual/arulesxl.css" />
<!-- #BeginEditable "doctitle" -->
<title>Reference - Multiple Rule Sets and Inheritance</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
</head>
<body bgcolor="#FFFFFF" text="#000033" link="#990066" vlink="#990099" alink="#9900FF">
<table width=100%>
<tr>
<td><h1><!-- #BeginEditable "head" -->Reference<font size=4> </font><!-- #EndEditable --></h1></td>
    <td><a href="http://www.arulesxl.com" target="_top"><img src="../../manual/images/logo.gif" width="150" height="115" border="0" align="right"></a></td>
</tr>
</table>
<hr>
<p><font size="-1"><b><a href="../../manual/index.htm" target=_top>Top</a> &nbsp;&nbsp;&nbsp;&nbsp;<a href="../../manual/install.htm">Installation</a> &nbsp;&nbsp;&nbsp;&nbsp;<a href="../../manual/introduction.htm">Introduction</a> &nbsp;&nbsp;&nbsp;&nbsp;<a href="../../manual/samples.htm">Samples</a>&nbsp;&nbsp;&nbsp;&nbsp; <a href="../../manual/tutorial.htm">Tutorial</a> &nbsp;&nbsp;&nbsp;&nbsp;<a href="../../manual/reference.htm">Reference</a> &nbsp;&nbsp;&nbsp;&nbsp;<a href="../../manual/release_notes.htm">Release Notes</a></b></font></p>
<hr>
<!-- #BeginEditable "body" --> 
<h2><a name="multiplerulesets"></a>Multiple Rule Sets and Inheritance </h2>
<p>
  <!amzi_index=Multiple Rule Sets; Rules Sets, Multiple; Performance; RXLDependency(); Load Rules Sets; Rule Sets, Loading>More complex applications often require multiple interrelated rule sets. Multiple 
rule sets require two types of relationships:</p>
<ul>
  <li>Logical relationships between the rule sets, and</li>
  <li>Excel dependency relationships.</li>
</ul>
<p>See <i>Techniques Advanced.xls</i> for an example.</p>
<h3><a name="logical_relationships"></a>Logical Relationships</h3>
<p>One rule set can reference properties in another rule set using this syntax:</p>
<pre>RuleSetName:.Property</pre>
<p>For example:</p>
<pre><b>.</b>UnitPrice = Gizmo<b>:.</b>UnitPrice when <b>.</b>Part = Gizmo</pre>
<p>In this case the <b><code>.</code></b><code>UnitPrice</code> is calculated 
  in the Gizmo rule set when <b><code>.</code></b><code>Part = Gizmo</code>.</p>
<p>A rule set can also inherit rules from other rule sets. This is done using 
  the INHERIT FROM command. For example if a specific part rule set for Widgets 
  inherited from a general Part rule set and also a Thing rule set the following 
  rule would implement that logical dependency:</p>
<pre>Inherit from Part Thing</pre>
<h3><a name="excel_dependency"></a>Excel Dependency</h3>
<!amzi_index=Excel Dependency;RXLDependency()>
<p> A rule set must be loaded in the reasoning engine before queries can be executed 
  against it. When there is just a single rule set, as in the examples so far, 
  this happens automatically when RQuery() is called.</p>
<p>When there are multiple rule sets it is necessary to ensure that all are loaded 
  when needed, and also that when any of the rule sets changes, queries dependent 
  on them are recalculated.</p>
<p>This is done by including the function <code>=RXLDependency(...)</code> in a main 
  rule set. For example, if the main rule set is PriceRules and it uses the rule 
  sets: Thing, Part, Widget, and Gizmo, then this function can be added to PriceRules 
  to capture that dependency:</p>
<pre>=RXLDependency(Thing, Part, Widget, Gizmo)</pre>
<p>Note that this ensures that all of the needed rule sets are loaded, and that 
  Excel maintains the appropriate dependency links, but does not imply any logical 
  relationship. That is done with the explicitly names and Inherit rule above.</p>
<h3><a name="inheritance"></a>Inheritance</h3>
<p>
  <!amzi_index=inherit from; Inheritance>
  A rule set can be a subclass of other rule sets, meaning that it can get properties 
  from its super class when those properties are not defined in the rule 
  set. The syntax is:</p>
<pre>INHERIT FROM superclass_1 superclass_2 ...</pre>
<p>Example:</p>
<pre>INHERIT FROM PartRules PriceRules</pre>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
  <tr>
    <th width="50%" scope="col"><div align="left">
      <h3><a href="../tutorial/tutor_tables_variables.htm">Previous</a></h3>
    </div></th>
    <th width="50%" scope="col"><div align="right">
      <h3><a href="../tutorial.htm">Next</a></h3>
    </div></th>
  </tr>
  <tr>
    <th colspan="2" scope="col"><h4><a href="ref_multiple_rulesets.htm" target="_blank">Open in New Window to Print</a></h4></th>
  </tr>
</table>
<!-- #EndEditable --> 
<hr>
<table width=100%>
<tr>
<td>
<img src="../../manual/images/logo_very_small.gif">
</td>
<td>
<h2 align="right">
<font size="2"><i>Copyright &copy;2005-7 <a href="http://www.amzi.com/">Amzi! inc.</a> All Rights Reserved.</i></font><br>
<font size="1"><i>ARulesXL and Amzi! are trademarks or registered trademarks of Amzi! <br>
Microsoft and Excel  are trademarks or registered trademarks of   Microsoft Corporation.</i></font></h2>
</td>
</tr>
</table>
</body>
<!-- #EndTemplate --></html>
